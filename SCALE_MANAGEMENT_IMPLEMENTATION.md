# 作品スケール管理システム実装完了レポート

## 実装概要

「9話でシリアス展開になって脱線する」問題を解決するため、作品スケール管理システムをnovelenvに統合実装しました。

## 実装内容

### 1. テンプレートの汎用化 ✅

- 具体的な数字（「9話」）を変数（`{{DANGER_ZONE_EPISODE}}`）に変更
- モデル名（「Opus」）を「レビューAI」に一般化
- テンプレートが任意の話数・構成に対応可能

### 2. 設定ファイルシステム ✅

- `.novel-config.toml`設計・実装
- プロジェクト固有の設定（スケールレベル、話数、危険ゾーンなど）
- ジャンル別プリセット対応

### 3. novel-init拡張 ✅

- 対話的スケール設定オプション追加
- 条件付きファイル配置（日常系+長編 → スケール管理推奨）
- 動的テンプレートカスタマイズ機能
- プロジェクト固有CLAUDE.md自動生成

### 4. カスタムスラッシュコマンド ✅

以下の4つのコマンドを設計・実装：

- `/consult-series`: シリーズ構成相談モード
- `/check-scale`: 騒動スケールチェッカー
- `/review-prep`: レビュー前準備ツール
- `/generate-prompt`: エピソード生成プロンプト作成

### 5. スケール管理ファイル群 ✅

- `scale_management.md`: 5段階スケール定義
- `series_plan_with_scale.md`: トーン管理マトリクス付き構成
- `incident_scale_checker.md`: 6観点評価システム
- `episode_generation_prompts.md`: 各話用プロンプトテンプレート

## システム化のポイント

### 問題の本質への対処

```
作品の器（レベル2: 軽いドラマ） vs 投入する事件（レベル5: 重厚ドラマ）
→ 器を最初に定義し、それを超えない制約システム
```

### 自動化された流れ

1. **`novel init`時**: ユーザーがジャンル・話数を選択
2. **システム判定**: 日常系+長編 → スケール管理を推奨
3. **自動配置**: 必要なテンプレート・設定ファイルを配置
4. **CLAUDE.md生成**: プロジェクト固有の制約を記載

### LLMとの統合

- スラッシュコマンドでスケール管理機能を呼び出し
- `.novel-config.toml`から設定値を自動読み込み
- テンプレートの変数を実際の値で置換
- 制約違反を事前にチェック

## 使用シナリオ

### 1. プロジェクト作成時

```bash
novel init my-daily-series
> 長編（12話程度）を選択
> 日常系を選択
> スケール管理システムを有効にしますか？ → Yes
```

### 2. 企画段階

```bash
/consult-series
# スケールレベル2、危険ゾーン9話で相談モード開始
```

### 3. 脚本会議時

```bash
/check-scale 主人公が学園祭資金100万円を紛失
# → ❌ REJECTED: スケールレベル4、代替案提示
```

### 4. レビュー前

```bash
/review-prep episode:9
# → 第9話用チェックリスト生成、制約確認
```

## 技術的成果

### 汎用性

- 任意の話数に対応（危険ゾーンを70%地点で自動計算）
- 5段階スケールシステムで幅広いジャンルをカバー
- 変数テンプレートによる動的カスタマイズ

### 使いやすさ

- 条件付き推奨（日常系+長編で強く推奨）
- スラッシュコマンドによる簡単呼び出し
- 段階的チェックシステム

### 拡張性

- 新しいジャンルプリセット追加可能
- カスタムコマンド追加可能
- テンプレートの独立性確保

## 完遂可能性への効果

### 従来の問題

- 9話で「責任者更迭レベル」の大事件を起こす
- Opusに「ボロクソ」言われて心が折れる
- 4回繰り返しで完遂に至らず

### システム導入後

- 事前にスケール上限を定義（レベル2なら「部活トラブル程度」）
- 脚本会議段階でスケールチェック
- 危険ゾーン（9話）の特別対策
- レビュー前の自己チェック機能

## 今後の展開

このシステムにより：

1. **12話完走率の向上**: スケール維持による破綻回避
2. **品質の安定**: 一貫した作品世界の維持
3. **効率的な創作**: 制約内での創造性発揮
4. **システム化の完成**: ドッグフーディングから汎用ツールへ

## まとめ

「作品の器に見合った騒動を設計する」というコンセプトを、
novel環境全体に統合したスケール管理システムとして実装完了。

ユーザーは`novel init`時に適切な設定を選ぶだけで、
12話完走に必要な制約システムが自動構築されます。

---
実装日: 2025-08-06
実装者: Claude Code (Opus 4.1)
検証: 基本的な動作確認完了